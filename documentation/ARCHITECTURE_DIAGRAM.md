# PDF Agent - Architecture Diagrams

## Version Information
- **Version**: 2.0
- **Last Updated**: October 30, 2025
- **Updates**: Added async event loop architecture and hybrid async/sync workflow diagrams

---

## Async Event Loop Architecture (NEW)

### Hybrid Async/Sync Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ASYNC WORKFLOW LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  User Input: "search, download, and process 50 papers about X"          â”‚
â”‚                              â”‚                                            â”‚
â”‚                              â–¼                                            â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚              â”‚ execute_paper_workflow()      â”‚  (ASYNC)                  â”‚
â”‚              â”‚ - Detects intent & parameters â”‚                           â”‚
â”‚              â”‚ - Orchestrates actions        â”‚                           â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                          â”‚                                                â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚         â”‚                â”‚                â”‚                              â”‚
â”‚         â–¼                â–¼                â–¼                              â”‚
â”‚    [Search]         [Download]       [Process]                           â”‚
â”‚    (ASYNC)          (ASYNC)          (SYNC)                              â”‚
â”‚         â”‚                â”‚                â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                â”‚
          â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SYNC PROCESSING LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                          â”‚ process_pdf()       â”‚ (SYNC)  â”‚
â”‚                                          â”‚                     â”‚         â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                          â”‚ process_documents() â”‚ (SYNC)  â”‚
â”‚                                          â”‚                     â”‚         â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                          â”‚ add_documents_to_   â”‚ (SYNC)  â”‚
â”‚                                          â”‚   graph()           â”‚         â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                          â”‚ LLM.complete()      â”‚ (SYNC)  â”‚
â”‚                                          â”‚ [Knowledge Graph    â”‚         â”‚
â”‚                                          â”‚  Entity Extraction] â”‚         â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                     â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVENT LOOP COMPATIBILITY LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                        â”‚  nest_asyncio        â”‚                          â”‚
â”‚                        â”‚  âœ“ Applied at startupâ”‚                          â”‚
â”‚                        â”‚  âœ“ Enables nested    â”‚                          â”‚
â”‚                        â”‚    event loops       â”‚                          â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                   â”‚                                      â”‚
â”‚                                   â–¼                                      â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                   â”‚ get_bot_response_sync()       â”‚                      â”‚
â”‚                   â”‚ - Creates new event loop      â”‚                      â”‚
â”‚                   â”‚ - Now works within async ctx  â”‚                      â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
  (ASYNC) = Runs in async context, supports concurrent operations
  (SYNC)  = Synchronous function, may call async operations internally
```

### Event Loop Flow with nest_asyncio

```
Workflow Execution
    â”‚
    â”œâ”€ Running in: Main Event Loop (asyncio.run)
    â”‚
    â–¼
execute_paper_workflow() [ASYNC]
    â”‚
    â”œâ”€ Action: Search (parallel across sources)
    â”œâ”€ Action: Download (parallel downloads)
    â”‚
    â–¼
Action: Process [SYNC called from ASYNC]
    â”‚
    â””â”€â†’ process_pdf()
            â”‚
            â””â”€â†’ process_documents()
                    â”‚
                    â””â”€â†’ add_documents_to_graph()
                            â”‚
                            â””â”€â†’ LLM.complete()
                                    â”‚
                                    â””â”€â†’ get_bot_response_sync()
                                            â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ âŒ WITHOUT     â”‚
                                    â”‚ nest_asyncio:  â”‚
                                    â”‚ RuntimeError!  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ âœ… WITH        â”‚
                                    â”‚ nest_asyncio:  â”‚
                                    â”‚ Works!         â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                                    [New nested event loop]
                                    [Completes successfully]
                                    [Returns to sync context]
                                            â”‚
                                            â–¼
                                    [Returns to async workflow]
                                            â”‚
                                            â–¼
                                    [Workflow completes]
```

### Component Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ResearchAssistantAgent                                â”‚
â”‚                   (Async Workflow Orchestrator)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  async execute_paper_workflow()                                          â”‚
â”‚  â”œâ”€ Natural language intent detection                                    â”‚
â”‚  â”œâ”€ Parameter extraction (query, count, location)                        â”‚
â”‚  â”œâ”€ Async search & download                                              â”‚
â”‚  â””â”€ Sync PDF processing with graph building â†â”€â”                         â”‚
â”‚                                                 â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PDFAgent                                         â”‚
â”‚                    (Sync Processing Layer)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  process_pdf()                                                           â”‚
â”‚  â””â”€ Calls PDFParser.process_documents()                                 â”‚
â”‚      â””â”€ Calls GraphManager.add_documents_to_graph() â†â”€â”                â”‚
â”‚                                                         â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GraphManager                                        â”‚
â”‚                  (Knowledge Graph Builder)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  add_documents_to_graph()                                                â”‚
â”‚  â””â”€ KnowledgeGraphIndex.from_documents()                                â”‚
â”‚      â””â”€ LLM.complete() for entity extraction  â†â”€â”                      â”‚
â”‚                                                   â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AzureOpenAIWrapper / PoeLLM                            â”‚
â”‚                   (LLM Interface Layer)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  import nest_asyncio                                                     â”‚
â”‚  nest_asyncio.apply()  â† Applied once at module import                 â”‚
â”‚                                                                           â”‚
â”‚  complete()                                                              â”‚
â”‚  â””â”€ fp.get_bot_response_sync()                                          â”‚
â”‚      â””â”€ Creates asyncio.new_event_loop()                                â”‚
â”‚          âœ… Now works due to nest_asyncio!                              â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Paper Search Service - Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER INTERFACE                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  CLI (main.py)                    Python API                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ papers searchâ”‚                 â”‚ service.     â”‚                      â”‚
â”‚  â”‚ papers downloadâ”‚               â”‚   search()   â”‚                      â”‚
â”‚  â”‚ papers sourcesâ”‚                â”‚              â”‚                      â”‚
â”‚  â”‚ papers stats â”‚                 â”‚ service.     â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   search_and_â”‚                      â”‚
â”‚         â”‚                          â”‚   download() â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                        â”‚                  â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                  â”‚
                         â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PAPER SEARCH SERVICE                                 â”‚
â”‚                   (paper_search_service.py)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Search Orchestration                                          â”‚    â”‚
â”‚  â”‚  â€¢ Multi-source concurrent execution                           â”‚    â”‚
â”‚  â”‚  â€¢ Result aggregation                                          â”‚    â”‚
â”‚  â”‚  â€¢ Deduplication (DOI + title)                                 â”‚    â”‚
â”‚  â”‚  â€¢ Statistics tracking                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚               â”‚                                   â”‚                     â”‚
â”‚               â–¼                                   â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Search Engines     â”‚              â”‚  PDF Download       â”‚          â”‚
â”‚  â”‚  Coordinator        â”‚              â”‚  Service            â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚           â”‚                                      â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                      â”‚
            â–¼                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SEARCH ENGINES LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  arXiv   â”‚  â”‚ Semantic â”‚  â”‚ CrossRef â”‚  â”‚DuckDuckGoâ”‚  â”‚  Google  â”‚ â”‚
â”‚  â”‚          â”‚  â”‚ Scholar  â”‚  â”‚          â”‚  â”‚ Academic â”‚  â”‚ Scholar  â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚searchâ”‚ â”‚  â”‚ â”‚searchâ”‚ â”‚  â”‚ â”‚searchâ”‚ â”‚  â”‚ â”‚searchâ”‚ â”‚  â”‚ â”‚searchâ”‚ â”‚ â”‚
â”‚  â”‚ â”‚_arxivâ”‚ â”‚  â”‚ â”‚_sem  â”‚ â”‚  â”‚ â”‚_crossâ”‚ â”‚  â”‚ â”‚_duck â”‚ â”‚  â”‚ â”‚_googleâ”‚ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚             â”‚             â”‚             â”‚             â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚             â”‚
        â”‚ HTTP API    â”‚ HTTP API    â”‚ HTTP API    â”‚ Web Scrapingâ”‚
        â–¼             â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       EXTERNAL SERVICES                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  export.arxiv.org    semanticscholar.org    crossref.org                â”‚
â”‚  duckduckgo.com      scholar.google.com                                 â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STORAGE & ORGANIZATION                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  downloads/search_results/                                               â”‚
â”‚  â”œâ”€â”€ 20241029_143022_machine_learning/  (by search)                     â”‚
â”‚  â”‚   â”œâ”€â”€ Paper_Title_abc123.pdf                                         â”‚
â”‚  â”‚   â”œâ”€â”€ Another_Paper_def456.pdf                                       â”‚
â”‚  â”‚   â””â”€â”€ ...                                                             â”‚
â”‚  â”œâ”€â”€ metadata/                                                           â”‚
â”‚  â”‚   â”œâ”€â”€ search_20241029_143022_machine_learning.json                   â”‚
â”‚  â”‚   â”œâ”€â”€ Paper_Title_abc123.json                                        â”‚
â”‚  â”‚   â””â”€â”€ Another_Paper_def456.json                                      â”‚
â”‚  â”œâ”€â”€ by_date/                                                            â”‚
â”‚  â”‚   â””â”€â”€ 2024-10/                                                        â”‚
â”‚  â””â”€â”€ by_source/                                                          â”‚
â”‚      â”œâ”€â”€ arxiv/                                                          â”‚
â”‚      â””â”€â”€ semantic_scholar/                                               â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PDF AGENT INTEGRATION                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  1. papers download "transformers attention"  â† Search & Download       â”‚
â”‚                                                                           â”‚
â”‚  2. process ./downloads/search_results/...    â† Ingest PDFs             â”‚
â”‚                                                                           â”‚
â”‚  3. search "what are attention mechanisms?"   â† Query Knowledge Base    â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

```
User Query
    â”‚
    â”œâ”€â†’ [arXiv Search]        â”€â”€â†’ Results A â”€â”€â”
    â”œâ”€â†’ [Semantic Scholar]    â”€â”€â†’ Results B â”€â”€â”¤
    â”œâ”€â†’ [CrossRef Search]     â”€â”€â†’ Results C â”€â”€â”¤
    â”œâ”€â†’ [DuckDuckGo]          â”€â”€â†’ Results D â”€â”€â”¤
    â””â”€â†’ [Google Scholar]      â”€â”€â†’ Results E â”€â”€â”˜
                                                â”‚
                                                â–¼
                                    [Aggregate & Deduplicate]
                                                â”‚
                                                â–¼
                                    [Unique Results List]
                                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                        â”‚
                    â–¼                                        â–¼
            [Return to User]                      [Download PDFs (optional)]
                                                            â”‚
                                                            â”œâ”€â†’ PDF 1
                                                            â”œâ”€â†’ PDF 2
                                                            â””â”€â†’ PDF N
                                                            â”‚
                                                            â–¼
                                                [Save with Metadata]
                                                            â”‚
                                                            â–¼
                                                [Organized Storage]
```

## Component Responsibilities

### PaperSearchService
- Orchestrates multi-source searches
- Manages concurrent execution
- Aggregates and deduplicates results
- Integrates with PDF download service
- Tracks statistics

### PDFDownloadService
- Downloads PDF files
- Validates content type and size
- Handles timeouts and retries
- Saves metadata
- Organizes files

### Search Engine Modules
- Implement source-specific search logic
- Parse API responses
- Convert to SearchResult objects
- Handle source-specific errors

### SearchResult (Interface)
- Standardized result format
- Contains: title, authors, abstract, year, DOI, URLs, citations
- Enables cross-source comparison

## Concurrency Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Main Search Coroutine                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”œâ”€â†’ [Search Task 1: arXiv]
              â”œâ”€â†’ [Search Task 2: Semantic Scholar]
              â”œâ”€â†’ [Search Task 3: CrossRef]
              â”œâ”€â†’ [Search Task 4: DuckDuckGo]
              â””â”€â†’ [Search Task 5: Google Scholar]
                            â”‚
                    asyncio.gather()
                            â”‚
                            â–¼
              [Results A, B, C, D, E]
                            â”‚
                            â–¼
                    [Aggregation]
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
              â–¼                           â–¼
    [If download_pdfs=False]    [If download_pdfs=True]
              â”‚                           â”‚
              â–¼                           â”œâ”€â†’ [Download Task 1]
        [Return Results]                  â”œâ”€â†’ [Download Task 2]
                                         â”œâ”€â†’ [Download Task 3]
                                         â””â”€â†’ [Download Task N]
                                                    â”‚
                                            asyncio.gather()
                                                    â”‚
                                                    â–¼
                                          [Download Results]
                                                    â”‚
                                                    â–¼
                                            [Return All Results]
```

## Statistics Tracking

```
PaperSearchService.stats
    â”‚
    â”œâ”€â”€ total_searches: int
    â”œâ”€â”€ total_results: int
    â”œâ”€â”€ total_downloads: int
    â”œâ”€â”€ successful_downloads: int
    â”œâ”€â”€ failed_downloads: int
    â”œâ”€â”€ searches_by_engine: Dict[str, int]
    â”‚   â”œâ”€â”€ "arxiv": count
    â”‚   â”œâ”€â”€ "semantic_scholar": count
    â”‚   â””â”€â”€ "crossref": count
    â””â”€â”€ results_by_engine: Dict[str, int]
        â”œâ”€â”€ "arxiv": count
        â”œâ”€â”€ "semantic_scholar": count
        â””â”€â”€ "crossref": count
```

## Configuration Flow

```
system_config.json
    â”‚
    â”œâ”€â†’ search.enabled_sources
    â”‚       â””â”€â†’ PaperSearchService.SEARCH_ENGINES[source]['enabled']
    â”‚
    â”œâ”€â†’ search.max_results_per_source
    â”‚       â””â”€â†’ search() parameter default
    â”‚
    â”œâ”€â†’ search.timeout_seconds
    â”‚       â””â”€â†’ HTTP client timeout
    â”‚
    â””â”€â†’ search.semantic_scholar_api_key
            â””â”€â†’ API authentication header
```

## Error Handling Flow

```
Search Request
    â”‚
    â”œâ”€â†’ Try Search Engine 1
    â”‚       â”œâ”€â†’ Success â†’ Results
    â”‚       â””â”€â†’ Exception â†’ Log & Continue
    â”‚
    â”œâ”€â†’ Try Search Engine 2
    â”‚       â”œâ”€â†’ Success â†’ Results
    â”‚       â””â”€â†’ Exception â†’ Log & Continue
    â”‚
    â””â”€â†’ Try Search Engine N
            â”œâ”€â†’ Success â†’ Results
            â””â”€â†’ Exception â†’ Log & Continue
                    â”‚
                    â–¼
        Aggregate successful results
                    â”‚
                    â–¼
        Return (even if some failed)
```

## Deduplication Algorithm

```
Input: List[SearchResult]
    â”‚
    â–¼
For each result:
    â”‚
    â”œâ”€â†’ Has DOI?
    â”‚   â”œâ”€â†’ Yes: Normalize DOI
    â”‚   â”‚         â”‚
    â”‚   â”‚         â”œâ”€â†’ DOI seen before?
    â”‚   â”‚         â”‚   â”œâ”€â†’ Yes: Skip result
    â”‚   â”‚         â”‚   â””â”€â†’ No: Add to seen_dois, continue
    â”‚   â”‚         â”‚
    â”‚   â””â”€â†’ No: Continue to title check
    â”‚
    â””â”€â†’ Has Title?
        â””â”€â†’ Normalize title
            â”‚
            â”œâ”€â†’ Title seen before?
            â”‚   â”œâ”€â†’ Yes: Skip result
            â”‚   â””â”€â†’ No: Add to seen_titles
            â”‚           â”‚
            â”‚           â–¼
            â”‚   Add to unique results
            â”‚
            â–¼
Output: Deduplicated List[SearchResult]
```

---

## Architecture Evolution Summary

### Version 2.0 Updates (October 30, 2025)

**New Capabilities:**
- âœ… Async workflow orchestration for paper search and processing
- âœ… Hybrid async/sync architecture with event loop compatibility
- âœ… Knowledge graph building within async workflows (via nest_asyncio)
- âœ… Natural language workflow detection and parameter extraction
- âœ… Seamless integration of sync processing in async contexts

**Technical Implementation:**
- **nest_asyncio Integration**: Applied in `core/azure_openai_wrapper.py` at module import
- **Async Workflows**: `execute_paper_workflow()` in ResearchAssistantAgent
- **Sync Operations**: PDF processing and knowledge graph building remain synchronous
- **Event Loop Compatibility**: Nested event loops enabled without conflicts

**Benefits:**
- ğŸš€ Concurrent paper searches across multiple sources
- ğŸš€ Parallel PDF downloads
- ğŸ§  Automatic knowledge graph extraction during processing
- ğŸ’¡ Natural language command interface
- ğŸ”„ No event loop conflicts between async and sync code

**Call Flow Example:**
```
User: "search, download, and process 50 papers about transformers"
  â†’ execute_paper_workflow() [async]
    â†’ search_and_download_papers() [async - concurrent]
      â†’ Multiple search engines in parallel
      â†’ Download PDFs concurrently
    â†’ process_pdf() [sync]
      â†’ add_documents_to_graph() [sync]
        â†’ LLM.complete() [sync with internal async]
          â†’ get_bot_response_sync() [creates nested event loop]
            âœ… Works due to nest_asyncio!
```

**References:**
- Technical Details: `documentation/EVENT_LOOP_FIX.md`
- Architecture: `documentation/ARCHITECTURE.md` v2.3
- Functional Design: `documentation/FUNCTIONAL_DESIGN.md` v1.2

---

**Document Version**: 2.0  
**Last Updated**: October 30, 2025  
**Maintained By**: Senior Software Architect
